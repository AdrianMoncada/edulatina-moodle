/**
 * Js file to handle settings.
 *
 * @package
 * @copyright   2021 WisdmLabs (https://wisdmlabs.com/) <support@wisdmlabs.com>
 * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @author      Wisdmlabs
 * @module      auth_edwiserbridge/settings
 */
define("auth_edwiserbridge/settings",["jquery","core/ajax","core/url","core/str"],(function($,ajax,url,str){return{init:function(){str.get_strings([{key:"dialog_title",component:"auth_edwiserbridge"},{key:"site_url",component:"auth_edwiserbridge"},{key:"token",component:"auth_edwiserbridge"},{key:"copy",component:"auth_edwiserbridge"},{key:"copied",component:"auth_edwiserbridge"},{key:"link",component:"auth_edwiserbridge"},{key:"create",component:"auth_edwiserbridge"},{key:"eb_empty_name_err",component:"auth_edwiserbridge"},{key:"eb_empty_user_err",component:"auth_edwiserbridge"},{key:"eb_service_select_err",component:"auth_edwiserbridge"},{key:"click_to_copy",component:"auth_edwiserbridge"},{key:"pop_up_info",component:"auth_edwiserbridge"},{key:"eb_settings_msg",component:"auth_edwiserbridge"},{key:"click_here",component:"auth_edwiserbridge"}]),$(document).ready((function(){function checkMissingServices(service_id){let messge_ele=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var promises=ajax.call([{methodname:"auth_edwiserbridge_get_service_info",args:{service_id:service_id}}]);promises[0].done((function(response){var message="";if($("body").css("cursor","default"),response.status)$("#web_service_status span").hasClass("summ_error")?($(".eb_summary_tab").removeClass("summary_tab_sucess"),$(".eb_summary_tab").addClass("summary_tab_error")):($(".eb_summary_tab").addClass("summary_tab_sucess"),$(".eb_summary_tab").removeClass("summary_tab_error")),messge_ele&&(message='<span style="color: #7ad03a;"><span class="summ_success" style="font-weight:bolder;color:#7ad03a;font-size:22px;">&#10003;</span></span>',$(messge_ele).empty().append(message));else if($(".eb_summary_tab").removeClass("summary_tab_sucess"),$(".eb_summary_tab").addClass("summary_tab_error"),messge_ele){if(messge_ele){var link=window.location.origin+window.location.pathname+"?tab=service",fix_link=M.util.get_string("more_details","auth_edwiserbridge")+" <a href='"+link+"'  target='_blank'>"+M.util.get_string("here","auth_edwiserbridge")+"</a>.";message="<span class='summ_error'>"+response.msg+fix_link+"</span>",$(messge_ele).empty().append(message)}}else $("#eb_common_err").text(response.msg),$("#eb_common_err").css("display","block");return response})).fail((function(response){return $("body").css("cursor","default"),0}))}if($(document).on("click",".eb_test_connection_log_open",(function(event){$(".eb_test_connection_log_open").addClass("eb_test_connection_log_close"),$(".eb_test_connection_log_close").removeClass("eb_test_connection_log_open"),$(".eb_test_connection_log").slideDown()})),$(document).on("click",".eb_test_connection_log_close",(function(event){$(".eb_test_connection_log_close").addClass("eb_test_connection_log_open"),$(".eb_test_connection_log_open").removeClass("eb_test_connection_log_close"),$(".eb_test_connection_log").slideUp()})),window.location.href.indexOf("edwiserbridge.php")>1){let searchParams=new URLSearchParams(window.location.search);if(searchParams.has("tab")&&"service"===searchParams.get("tab"))""!=(service_id=$("#id_eb_sevice_list").val())&&"create"!=service_id&&checkMissingServices(service_id);else if(searchParams.has("tab")&&"summary"===searchParams.get("tab")){var service_id;checkMissingServices(service_id=$("#web_service_status").data("serviceid"),"#web_service_status"),setTimeout((function(){!function(){let messge_ele=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var wp_url=$("#eb_wp_url").text(),wp_token=$("#eb_wp_token").text();ajax.call([{methodname:"auth_edwiserbridge_test_connection",args:{wp_url:wp_url,wp_token:wp_token}}])[0].done((function(response){var message="";if($("body").css("cursor","default"),"0"==response.status)if($(".eb_summary_tab").removeClass("summary_tab_sucess"),$(".eb_summary_tab").addClass("summary_tab_error"),messge_ele){if(messge_ele){var fix_link=" Check more detials <a href='"+(window.location.origin+window.location.pathname)+"?tab=connection'  target='_blank'>here</a>.";message="<span class='summ_error'>"+response.msg+fix_link+"</span>",$(messge_ele).empty().append(message)}}else $("#eb_common_err").text(response.msg),$("#eb_common_err").css("display","block");else $("#test_connection_status span").hasClass("summ_error")?($(".eb_summary_tab").removeClass("summary_tab_sucess"),$(".eb_summary_tab").addClass("summary_tab_error")):($(".eb_summary_tab").addClass("summary_tab_sucess"),$(".eb_summary_tab").removeClass("summary_tab_error")),messge_ele&&(message='<span style="color: #7ad03a;"><span class="summ_success" style="font-weight: bolder; color: #7ad03a; font-size: 22px;">&#10003; '+response.msg+"</span></span>",$(messge_ele).empty().append(message));return response})).fail((function(response){return $("body").css("cursor","default"),0}))}("#test_connection_status")}),1e3)}}function toaster(title){let time=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;const id="auth_edwiserbridge_copy",toast=$('<div id="'+id+'">'+M.util.get_string("copied","auth_edwiserbridge")+"<div>").get(0);document.querySelector("body").appendChild(toast),toast.classList.add("show"),setTimeout((function(){toast.classList.add("fade"),setTimeout((function(){toast.classList.remove("fade"),setTimeout((function(){toast.remove()}),time)}),time)}))}$("#id_eb_sevice_list").change((function(){var service_id=$(this).val();$("#eb_common_success").css("display","none"),$("#eb_common_err").css("display","none"),$("#id_eb_token option:selected").removeAttr("selected"),$('#id_eb_token option[value=""]').attr("selected",!0),function(condition,condition_var,element){let btn=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";condition==condition_var?($(btn).text(M.util.get_string("create","auth_edwiserbridge")),$(element).css("display","flex")):($(btn).text(M.util.get_string("link","auth_edwiserbridge")),$(element).css("display","none"))}("create",service_id,".eb_service_field","#id_eb_mform_create_service"),""!=$(this).val()&&($("#id_eb_token").children("option").hide(),$("#id_eb_token").children("option[data-id^="+$(this).val()+"]").show(),"create"!=$(this).val()&&($("body").css("cursor","progress"),checkMissingServices(service_id)))})),$("#service_submit_continue").click((function(){$(this).closest("form").attr("action",M.cfg.wwwroot+"/auth/edwiserbridge/edwiserbridge.php?tab=connection")})),$("#conne_submit_continue").click((function(){$(this).closest("form").attr("action",M.cfg.wwwroot+"/auth/edwiserbridge/edwiserbridge.php?tab=synchronization")})),$("#sync_submit_continue").click((function(){$(this).closest("form").attr("action",M.cfg.wwwroot+"/auth/edwiserbridge/edwiserbridge.php?tab=sso")})),$("#sso_submit_continue").click((function(){$(this).closest("form").attr("action",M.cfg.wwwroot+"/auth/edwiserbridge/edwiserbridge.php?tab=summary")})),$("#settings_submit_continue").click((function(){$(this).closest("form").attr("action",M.cfg.wwwroot+"/auth/edwiserbridge/edwiserbridge.php?tab=service")})),$(".eb_settings_btn_cont").length||$("#admin-eb_setup_wizard_field").before('<div class="eb_settings_btn_cont" style="padding: 30px;"> '+M.util.get_string("eb_settings_msg","auth_edwiserbridge")+' <a target="_blank" style="border-radius:4px;margin-left:5px;padding:7px 18px;" class="eb_settings_btn btn btn-primary" href="'+M.cfg.wwwroot+'/auth/edwiserbridge/setup_wizard.php"> '+M.util.get_string("click_here","auth_edwiserbridge")+" </a></div>"),$("#admin-eb_setup_wizard_field").css("display","none"),$("#admin-ebnewserviceuserselect").length&&($("#eb_create_service").length||$("#admin-ebnewserviceuserselect").after('<div class="row eb_create_service_wrap">  <div class="offset-sm-3 col-sm-3">    <button type="submit" id="eb_create_service" class="btn">'+M.util.get_string("link","auth_edwiserbridge")+"</button>  </div></div>")),$(".eb_create_service_wrap").length&&$(".eb_create_service_wrap").before('<div class="row eb_common_err_wrap">  <div class="offset-sm-3 col-sm-3">    <span id="eb_common_err" class="btn"></span>    <span id="eb_common_success" class="btn"></span>  </div></div>'),$("#id_eb_mform_create_service").click((function(event){event.preventDefault();var error=0,web_service_name=$("#id_eb_service_inp").val(),user_id=$("#id_eb_auth_users_list").val(),service_id=$("#id_eb_sevice_list").val(),token=$("#id_eb_token").val();if($(".eb_settings_err").remove(),$("#eb_common_success").css("display","none"),$("#eb_common_err").css("display","none"),""==user_id&&($("#eb_common_err").text(M.util.get_string("eb_empty_user_err","auth_edwiserbridge")),$("#eb_common_err").css("display","block"),error=1),"create"==service_id){if(""==web_service_name&&($("#eb_common_err").css("display","block"),$("#eb_common_err").text(M.util.get_string("eb_empty_name_err","auth_edwiserbridge")),error=1),error)return;!function(web_service_name,user_id,service_select_fld,common_errr_fld,is_mform){$("body").css("cursor","progress"),$("#eb_common_err").css("display","none"),$("#id_eb_token option:selected").removeAttr("selected"),$('#id_eb_token option[value=""]').attr("selected",!0);var promises=ajax.call([{methodname:"auth_edwiserbridge_create_service",args:{web_service_name:web_service_name,user_id:user_id}}]);promises[0].done((function(response){if($("body").css("cursor","default"),response.status){var eb_dialog_content="<div> "+M.util.get_string("pop_up_info","auth_edwiserbridge")+' </div><table class="eb_toke_detail_tbl">  <tr>     <th width="17%">'+M.util.get_string("site_url","auth_edwiserbridge")+'</th>     <td> : <span class="eb_copy_text" title="'+M.util.get_string("click_to_copy","auth_edwiserbridge")+'">'+response.site_url+'</span>        <span class="eb_copy_btn">'+M.util.get_string("copy","auth_edwiserbridge")+'</span></td>  </tr>  <tr>     <th width="17%">'+M.util.get_string("token","auth_edwiserbridge")+'</th>     <td> : <span class="eb_copy_text" title="'+M.util.get_string("click_to_copy","auth_edwiserbridge")+'">'+response.token+'</span>        <span class="eb_copy_btn">'+M.util.get_string("copy","auth_edwiserbridge")+"</span></td>  </tr></table>";$("body").append('<div class="eb_service_pop_up_cont"><div class="eb_service_pop_up"><span class="helper"></span><div><div class="eb_service_pop_up_close">&times;</div><div><div class="eb_service_pop_up_title"></div><div class="eb_service_pop_up_content"></div></div></div></div></div>'),$(".eb_service_pop_up_content").html(eb_dialog_content),$(".eb_service_pop_up").show(),element=service_select_fld,name=web_service_name,id=response.service_id,$(element+"option:selected").removeAttr("selected"),$(element).append('<option value="'+id+'" selected> '+name+" </option>"),function(element,token,id){$(element+"option:selected").removeAttr("selected"),$(element).append('<option data-id="'+id+'" value="'+token+'" selected> '+token+" </option>")}("#id_eb_token",response.token,response.service_id)}else $("#eb_common_err").css("display","block"),$(common_errr_fld).text(response.msg);var element,name,id;return response})).fail((function(response){return $("body").css("cursor","default"),0}))}(web_service_name,user_id,"#id_eb_sevice_list","#eb_common_err")}else{if(""==$("#id_eb_token").val())return $("#eb_common_err").css("display","block"),$("#eb_common_err").text(M.util.get_string("token_empty","auth_edwiserbridge")),error=1,0;if(error)return;""!=service_id?function(service_id,token,common_errr_fld,common_success_fld){$("body").css("cursor","progress"),$("#eb_common_err").css("display","none"),ajax.call([{methodname:"auth_edwiserbridge_link_service",args:{service_id:service_id,token:token}}])[0].done((function(response){return $("body").css("cursor","default"),response.status?($(common_success_fld).text(response.msg),$(common_success_fld).css("display","block")):($(common_errr_fld).text(response.msg),$(common_success_fld).css("display","block")),response})).fail((function(response){return $("body").css("cursor","default"),0}))}(service_id,token,"#eb_common_err","#eb_common_success"):$("#eb_common_err").text(M.util.get_string("eb_service_select_err","auth_edwiserbridge"))}})),$(document).on("mouseenter",".eb_copy_text_wrap",(function(){$(this).find(".eb_copy_btn").css("visibility","visible")})),$(document).on("mouseleave",".eb_copy_text_wrap",(function(){$(this).find(".eb_copy_btn").css("visibility","hidden")})),$(document).on("click",".eb_copy_text_wrap",(function(event){event.preventDefault();var copyText=$(this).find(".eb_copy_text").html().trim();navigator.clipboard.writeText(copyText).then((()=>{toaster(M.util.get_string("copied","auth_edwiserbridge"),400)}))})),$(document).on("click",".eb_primary_copy_btn",(function(event){event.preventDefault();var parent=$(this).parent().parent();if("id_eb_token"==(parent=parent.find(".eb_copy")).attr("id"))var copyText=parent.val().trim();else copyText=parent.text().trim();navigator.clipboard.writeText(copyText).then((()=>{toaster(M.util.get_string("copied","auth_edwiserbridge"),200)}))})),$(document).on("click",".eb_service_pop_up_close",(function(){$(".eb_service_pop_up").hide()}));$("body").append('<div id="eb-lading-parent" class="eb-lading-parent-wrap"><div class="eb-loader-progsessing-anim"></div></div>'),$(document).on("click",".eb_setup_save_and_continue",(function(event){$(this);var current_step=$(this).data("step"),next_step=$(this).data("next-step"),is_next_sub_step=$(this).data("is-next-sub-step"),data={current_step:current_step,next_step:next_step,is_next_sub_step:is_next_sub_step};switch(current_step){case"installtion_guide":case"mdl_plugin_config":$("#eb-lading-parent").show(),data={current_step:current_step,next_step:next_step,is_next_sub_step:is_next_sub_step};break;case"web_service":var service_name=$(".eb_setup_web_service_list").val();if("create"==service_name&&""==$("#eb_setup_web_service_name").val())return event.preventDefault(),void $("#eb_setup_web_service_name").css("border-color","red");$("#eb-lading-parent").show();var existing_service=1;"create"==service_name&&""!=service_name&&(service_name=$(".eb_setup_web_service_name").val(),existing_service=0),data={current_step:current_step,next_step:next_step,is_next_sub_step:is_next_sub_step,service_name:service_name,existing_service:existing_service};break;case"wordpress_site_details":if(""!=site_name&&(""==$("#eb_setup_site_name").val()||""==$("#eb_setup_site_url").val()))return event.preventDefault(),""==$("#eb_setup_site_name").val()?$("#eb_setup_site_name").css("border-color","red"):$("#eb_setup_site_name").css("border-color","#E5E5E5"),void(""==$("#eb_setup_site_url").val()?$("#eb_setup_site_url").css("border-color","red"):$("#eb_setup_site_url").css("border-color","#E5E5E5"));$("#eb-lading-parent").show();var site_name=$(".eb_setup_wp_sites").val(),url="";""!=site_name&&(site_name=$(".eb_setup_site_name").val(),url=$(".eb_setup_site_url").val()),data={current_step:current_step,next_step:next_step,is_next_sub_step:is_next_sub_step,site_name:site_name,url:url};break;case"user_and_course_sync":$("#eb-lading-parent").show();var user_enrollment=$("#eb_setup_sync_user_enrollment").prop("checked")?1:0,user_unenrollment=$("#eb_setup_sync_user_unenrollment").prop("checked")?1:0,user_creation=$("#eb_setup_sync_user_creation").prop("checked")?1:0,user_deletion=$("#eb_setup_sync_user_deletion").prop("checked")?1:0,user_update=$("#eb_setup_sync_user_update").prop("checked")?1:0,course_creation=$("#eb_setup_sync_course_creation").prop("checked")?1:0,course_deletion=$("#eb_setup_sync_course_deletion").prop("checked")?1:0;data={current_step:current_step,next_step:next_step,is_next_sub_step:is_next_sub_step,user_enrollment:user_enrollment,user_unenrollment:user_unenrollment,user_creation:user_creation,user_deletion:user_deletion,user_update:user_update,course_creation:course_creation,course_deletion:course_deletion};break;default:$("#eb-lading-parent").show()}data=JSON.stringify(data),ajax.call([{methodname:"auth_edwiserbridge_setup_wizard_save_and_continue",args:{data:data}}])[0].done((function(response){$("#eb-lading-parent").hide(),function(step){var url=new URL(document.location);url.searchParams.set("current_step",step),window.history.replaceState(null,null,url)}(next_step);return function(current_step,next_step,is_next_sub_step,parent_step){$(".eb-setup-step-"+current_step).addClass("eb-setup-step-completed-wrap"),$(".eb-setup-step-"+current_step).hasClass("eb-setup-step-active-wrap")&&$(".eb-setup-step-"+current_step).removeClass("eb-setup-step-active-wrap");var icon,step_title=$(".eb-setup-step-"+current_step).children(".eb-setup-steps-title");step_title.addClass("eb-setup-step-completed"),step_title.hasClass("eb-setup-step-active")&&step_title.removeClass("eb-setup-step-active"),(icon=$(".eb-setup-step-"+current_step).children(".eb_setup_sidebar_progress_icons")).addClass("fa-circle-check"),icon.hasClass("fa-circle-chevron-right")&&icon.removeClass("fa-circle-chevron-right"),$(".eb-setup-step-"+next_step).addClass("eb-setup-step-active-wrap"),$(".eb-setup-step-"+next_step).children(".eb-setup-steps-title").addClass("eb-setup-step-active"),(icon=$(".eb-setup-step-"+next_step).children(".eb_setup_sidebar_progress_icons")).addClass("fa-solid fa-circle-chevron-right"),icon.hasClass("eb-setup-step-circle")&&icon.removeClass("eb-setup-step-circle")}(current_step,next_step),$(".eb-setup-header-title").html(response.title),$(".eb-setup-content").html(response.html_data),"complete_details"==next_step&&($(".eb-setup-content").append('<div class="eb_setup_popup"> '+$(".eb_setup_wp_completion_success_popup").html()+" </div>"),setTimeout((function(){$(".eb_setup_popup").remove()}),2e3)),response})).fail((function(response){return $("#eb-lading-parent").hide(),$("body").css("cursor","default"),0}))})),$(".eb_setup_wp_completion_success_popup").length&&($(".eb-setup-content").append('<div class="eb_setup_popup"> '+$(".eb_setup_wp_completion_success_popup").html()+" </div>"),setTimeout((function(){$(".eb_setup_popup").remove()}),2e3)),$(document).on("click",".eb_enable_plugin_settings",(function(event){$("#eb-lading-parent").show(),ajax.call([{methodname:"auth_edwiserbridge_enable_plugin_settings",args:{}}])[0].done((function(response){return $("body").css("cursor","default"),$("#eb-lading-parent").hide(),$(".eb_enable_rest_protocol").css("color","#1AB900"),$(".eb_enable_web_service").css("color","#1AB900"),$(".eb_disable_pwd_policy").css("color","#1AB900"),$(".eb_allow_extended_char").css("color","#1AB900"),$(".eb_setup_settings_success_msg").css("display","block"),$(".eb_enable_plugin_settings").css("display","none"),$(".eb_enable_plugin_settings_label").css("display","none"),$(".eb_setup_save_and_continue").css("display","initial"),response})).fail((function(response){return $("#eb-lading-parent").hide(),$("body").css("cursor","default"),0}))}));var i,acc=document.getElementsByClassName("accordion");for(i=0;i<acc.length;i++)acc[i].addEventListener("click",(function(){this.classList.toggle("active");var panel=this.nextElementSibling;"block"===panel.style.display?panel.style.display="none":panel.style.display="block"}));$(document).on("change",".eb_setup_web_service_list",(function(event){""!=$(".eb_setup_web_service_list").val()?($(".eb_setup_web_service_btn").removeClass("disabled"),$(".eb_setup_web_service_btn").removeAttr("disabled")):($(".eb_setup_web_service_btn").attr("disabled","disabled"),$(".eb_setup_web_service_btn").addClass("disabled")),"create"==$(".eb_setup_web_service_list").val()?$(".eb_setup_web_service_name_wrap").css("display","block"):$(".eb_setup_web_service_name_wrap").css("display","none")})),$(document).on("change",".eb_setup_wp_sites",(function(event){if(""!=$(".eb_setup_web_service_list").val()?($(".eb_setup_wp_details_btn").removeClass("disabled"),$(".eb_setup_wp_details_btn").removeAttr("disabled")):($(".eb_setup_wp_details_btn").attr("disabled","disabled"),$(".eb_setup_wp_details_btn").addClass("disabled")),""==$(".eb_setup_wp_sites").val())$(".eb_setup_wp_site_details_inp").addClass("eb_setup_wp_site_details_wrap");else{$(".eb_setup_wp_site_details_inp").removeClass("eb_setup_wp_site_details_wrap");var option=$(this).find(":selected");$(".eb_setup_site_name").val(option.data("name")),$(".eb_setup_site_url").val(option.data("url"))}})),$(document).on("click",".eb_setup_test_connection_btn",(function(event){var url=$(".eb_setup_site_url").val();$("body").css("cursor","wait"),$("#eb-lading-parent").show(),ajax.call([{methodname:"auth_edwiserbridge_setup_test_connection",args:{wp_url:url}}])[0].done((function(response){return $("#eb-lading-parent").hide(),$("body").css("cursor","default"),$(".eb_setup_test_conn_resp_msg").css("display","block"),1==response.status?($(".eb_setup_test_connection_continue_btn").css("display","inline-block"),$(".eb_setup_test_connection_btn").css("display","none"),$(".eb_setup_test_conn_resp_msg").addClass("eb_setup_settings_success_msg"),$(".eb_setup_test_conn_resp_msg").html('<i class="fa-solid fa-circle-check"></i> '+response.msg),$(".eb_setup_test_conn_resp_msg").removeClass("eb_setup_error_msg_box")):($(".eb_setup_test_conn_resp_msg").addClass("eb_setup_error_msg_box"),$(".eb_setup_test_conn_resp_msg").html('<i class="fa-solid fa-circle-check"></i> '+response.msg),$(".eb_setup_test_conn_resp_msg").removeClass("eb_setup_settings_success_msg")),response})).fail((function(response){return $("body").css("cursor","default"),$("#eb-lading-parent").hide(),0}))})),$(document).on("click","#eb_setup_sync_all",(function(event){this.checked?$(".eb_setup_sync_cb").prop("checked",!0):$(".eb_setup_sync_cb").prop("checked",!1)})),$(document).on("click",".eb_setup_sync_cb",(function(event){if(this.checked){var all_checked=1;$(".eb_setup_sync_cb").each((function(){this.checked||(all_checked=0)})),all_checked&&$("#eb_setup_sync_all").prop("checked",!0)}else $("#eb_setup_sync_all").prop("checked",!1)})),$(document).on("click",".eb_setup_copy",(function(event){event.preventDefault();var copyText=$(this).data("copy");navigator.clipboard.writeText(copyText).then((()=>{var copy_success='<p class="eb_setup_copy_success"><i class="fa fa-check" aria-hidden="true"></i> '+M.util.get_string("copied","auth_edwiserbridge")+"</p>";$(this).append(copy_success),setTimeout((()=>{$(".eb_setup_copy_success").fadeOut(300,(function(){$(this).remove()}))}),2e3)}))})),$(document).on("click",".eb_setup_download_creds",(function(event){var obj={url:$(".eb_setup_copy_url").html(),token:$(".eb_setup_copy_token").html(),lang_code:$(".eb_setup_copy_lang").html()};$("<a />",{download:"creds.json",href:"data:application/json,"+encodeURIComponent(JSON.stringify(obj))}).appendTo("body").click((function(){$(this).remove()}))[0].click()})),$(".eb-setup-close-icon").click((function(){$(".eb-setup-content").append('<div class="eb_setup_popup"> '+$(".eb_setup_popup_content_wrap").html()+" </div>")})),$(document).on("click",".eb_setup_do_not_close",(function(event){$(".eb_setup_popup").remove()})),$(document).on("change",".eb_setup_wp_sites",(function(event){var option=$(this).find(":selected");$(".eb_setup_site_name").val(option.data("name")),$(".eb_setup_site_url").val(option.data("url"))})),$(document).on("click",".eb_redirect_to_wp",(function(event){event.preventDefault();$(this);var data={current_step:$(this).data("step"),next_step:$(this).data("next-step"),is_next_sub_step:$(this).data("is-next-sub-step")};data=JSON.stringify(data),ajax.call([{methodname:"auth_edwiserbridge_setup_wizard_save_and_continue",args:{data:data}}])[0].done((function(response){return response})).fail((function(response){return 0})),$(".eb-setup-content").append('<div class="eb_setup_popup"> '+$(".eb_setup_wp_redirection_popup").html()+" </div>"),setTimeout((function(){$(".eb_setup_popup").remove(),$(".eb_redirect_to_wp_btn").trigger("click"),window.open($(".eb_redirect_to_wp").attr("href"),"_blank").focus()}),2e3)}))}))}}}));

//# sourceMappingURL=settings.min.js.map